#ok
class StreamListener(tweepy.StreamListener):

    def on_status(self, status):
        
        try:
            text = status.text.encode("utf8","ignore")
            text = str(text)+'\n'
            loc = status.user.location
            l = [', MI', 'michigan', 'Michigan']                
            if loc != None:
                for i in l:
                    if i in loc:
                        
                        print (loc)
                        with open('t1.json', 'a') as f: 
                            f.write(text)
                            return True
        except TypeError as e:
            print(str(e))
        return True
        
    def on_error(self, status_code):
        if status_code == 420:
            return False
stream_listener = StreamListener()
stream = tweepy.Stream(auth=api.auth, listener=stream_listener)
stream.filter(track=["trump"])
